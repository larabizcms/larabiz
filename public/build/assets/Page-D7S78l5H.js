const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ElementBuilder-BhrjtMtI.js","assets/index-C7XDJ_kP.js","assets/index-SXG1nv-J.css","assets/LoadingButton-C5RViJFF.js","assets/InputLabel-R-0Q6san.js","assets/OutlinedInput-Dl_FMo8h.js","assets/Alert-swsxPqK4.js","assets/useTranslation-FWVaBoU2.js","assets/MediaPreview-Cap6zzTb.js","assets/AntdIcon-ukZYJwBt.js","assets/unsupportedIterableToArray-Ba7u8soi.js","assets/TextField-MqqGQb-4.js","assets/FormControl-RPBU6GsC.js","assets/MenuList-DCFZAF55.js","assets/ListItem-CmJxDpdd.js","assets/Checkbox-Wx-LT1lb.js","assets/FormControlLabel-CtregJwz.js","assets/MediaDialog-DejNNsWp.js","assets/DialogTitle-xXCWR_NU.js"])))=>i.map(i=>d[i]);
import{J as oe,K as ne,M as R,N as C,O as J,Q as ce,U as le,r as z,V as de,X as pe,p as P,j as e,Y as me,Z as ue,$ as Y,G as m,B as E,b as F,a0 as I,t as p,a1 as M,u as he,a as xe,a2 as ge,m as H,R as d,H as q,a3 as fe,a4 as je,a5 as be,a6 as ve,C as X,d as Se,o as L,a7 as we,s as ye,a8 as Ce,a9 as V,aa as U,ab as O,ac as G,ad as A,v as ke,ae as $e,af as Pe,ag as Ie,ah as Me,P as _e}from"./index-C7XDJ_kP.js";import{L as Z}from"./LoadingPage-CeAK0BaF.js";import{A as ee,u as te,T as W,L as se,C as Be,E as Te}from"./LoadingButton-C5RViJFF.js";import{E as ae,B as re,L as Le}from"./ElementBuilder-BhrjtMtI.js";import{U as K,I as Fe,M as Ae}from"./InfiniteScroll-DjqvMlpW.js";import{m as Ee}from"./makeStyles-BXIMhz0Y.js";import{D as Re,a as ze,b as De,c as Ne}from"./DialogTitle-xXCWR_NU.js";import{T as Q,a as Ve,b as Ue,c as Oe,d as Ge}from"./TableRow-DCPirH5Y.js";import{T as w}from"./TableCell-zCgwM2Jb.js";import{S as He}from"./FormControlLabel-CtregJwz.js";import{I as We}from"./AntdIcon-ukZYJwBt.js";import"./InputLabel-R-0Q6san.js";import"./OutlinedInput-Dl_FMo8h.js";import"./Alert-swsxPqK4.js";import"./useTranslation-FWVaBoU2.js";import"./MediaPreview-Cap6zzTb.js";import"./TextField-MqqGQb-4.js";import"./FormControl-RPBU6GsC.js";import"./MenuList-DCFZAF55.js";import"./ListItem-CmJxDpdd.js";import"./Checkbox-Wx-LT1lb.js";import"./tslib.es6-4OAZryUH.js";import"./toConsumableArray-CXkg9hOZ.js";import"./unsupportedIterableToArray-Ba7u8soi.js";function Qe(t){return ne("MuiSwitch",t)}const h=oe("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]),qe=["className","color","edge","size","sx"],Xe=t=>{const{classes:s,edge:r,size:a,color:l,checked:o,disabled:u}=t,n={root:["root",r&&`edge${C(r)}`,`size${C(a)}`],switchBase:["switchBase",`color${C(l)}`,o&&"checked",u&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},i=ue(n,Qe,s);return P({},s,i)},Je=R("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(t,s)=>{const{ownerState:r}=t;return[s.root,r.edge&&s[`edge${C(r.edge)}`],s[`size${C(r.size)}`]]}})({display:"inline-flex",width:34+12*2,height:14+12*2,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"},variants:[{props:{edge:"start"},style:{marginLeft:-8}},{props:{edge:"end"},style:{marginRight:-8}},{props:{size:"small"},style:{width:40,height:24,padding:7,[`& .${h.thumb}`]:{width:16,height:16},[`& .${h.switchBase}`]:{padding:4,[`&.${h.checked}`]:{transform:"translateX(16px)"}}}}]}),Ke=R(He,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(t,s)=>{const{ownerState:r}=t;return[s.switchBase,{[`& .${h.input}`]:s.input},r.color!=="default"&&s[`color${C(r.color)}`]]}})(({theme:t})=>({position:"absolute",top:0,left:0,zIndex:1,color:t.vars?t.vars.palette.Switch.defaultColor:`${t.palette.mode==="light"?t.palette.common.white:t.palette.grey[300]}`,transition:t.transitions.create(["left","transform"],{duration:t.transitions.duration.shortest}),[`&.${h.checked}`]:{transform:"translateX(20px)"},[`&.${h.disabled}`]:{color:t.vars?t.vars.palette.Switch.defaultDisabledColor:`${t.palette.mode==="light"?t.palette.grey[100]:t.palette.grey[600]}`},[`&.${h.checked} + .${h.track}`]:{opacity:.5},[`&.${h.disabled} + .${h.track}`]:{opacity:t.vars?t.vars.opacity.switchTrackDisabled:`${t.palette.mode==="light"?.12:.2}`},[`& .${h.input}`]:{left:"-100%",width:"300%"}}),({theme:t})=>({"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.activeChannel} / ${t.vars.palette.action.hoverOpacity})`:J(t.palette.action.active,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[...Object.entries(t.palette).filter(([,s])=>s.main&&s.light).map(([s])=>({props:{color:s},style:{[`&.${h.checked}`]:{color:(t.vars||t).palette[s].main,"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette[s].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:J(t.palette[s].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${h.disabled}`]:{color:t.vars?t.vars.palette.Switch[`${s}DisabledColor`]:`${t.palette.mode==="light"?ce(t.palette[s].main,.62):le(t.palette[s].main,.55)}`}},[`&.${h.checked} + .${h.track}`]:{backgroundColor:(t.vars||t).palette[s].main}}}))]})),Ye=R("span",{name:"MuiSwitch",slot:"Track",overridesResolver:(t,s)=>s.track})(({theme:t})=>({height:"100%",width:"100%",borderRadius:14/2,zIndex:-1,transition:t.transitions.create(["opacity","background-color"],{duration:t.transitions.duration.shortest}),backgroundColor:t.vars?t.vars.palette.common.onBackground:`${t.palette.mode==="light"?t.palette.common.black:t.palette.common.white}`,opacity:t.vars?t.vars.opacity.switchTrack:`${t.palette.mode==="light"?.38:.3}`})),Ze=R("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:(t,s)=>s.thumb})(({theme:t})=>({boxShadow:(t.vars||t).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"})),ie=z.forwardRef(function(s,r){const a=de({props:s,name:"MuiSwitch"}),{className:l,color:o="primary",edge:u=!1,size:n="medium",sx:i}=a,x=pe(a,qe),c=P({},a,{color:o,edge:u,size:n}),j=Xe(c),g=e.jsx(Ze,{className:j.thumb,ownerState:c});return e.jsxs(Je,{className:me(j.root,l),sx:i,ownerState:c,children:[e.jsx(Ke,P({type:"checkbox",icon:g,checkedIcon:g,ref:r,ownerState:c},x,{classes:P({},j,{root:j.switchBase})})),e.jsx(Ye,{className:j.track,ownerState:c})]})}),et=Y(e.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-7 3c1.93 0 3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5S10.07 6 12 6m7 13H5v-.23c0-.62.28-1.2.76-1.58C7.47 15.82 9.64 15 12 15s4.53.82 6.24 2.19c.48.38.76.97.76 1.58z"}),"AccountBox"),tt=Y(e.jsx("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2m-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2m3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1z"}),"Lock");var st={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 112c-3.8 0-7.7.7-11.6 2.3L292 345.9H128c-8.8 0-16 7.4-16 16.6v299c0 9.2 7.2 16.6 16 16.6h101.6c-3.7 11.6-5.6 23.9-5.6 36.4 0 65.9 53.8 119.5 120 119.5 55.4 0 102.1-37.6 115.9-88.4l408.6 164.2c3.9 1.5 7.8 2.3 11.6 2.3 16.9 0 32-14.2 32-33.2V145.2C912 126.2 897 112 880 112zM344 762.3c-26.5 0-48-21.4-48-47.8 0-11.2 3.9-21.9 11-30.4l84.9 34.1c-2 24.6-22.7 44.1-47.9 44.1z"}}]},name:"notification",theme:"filled"},at=function(s,r){return z.createElement(We,P({},s,{ref:r,icon:st}))},rt=z.forwardRef(at);function it({page:t,uri:s}){return e.jsxs(m,{container:!0,spacing:3,children:[e.jsx(m,{item:!0,xs:12,sx:{display:"flex",justifyContent:"right"},children:e.jsx(ee,{children:e.jsx(E,{disableElevation:!0,fullWidth:!0,type:"button",variant:"contained",color:"success",component:F,startIcon:e.jsx(I,{children:"add"}),to:"/admin-cp/"+s+"/create",children:p("Add New")})})}),e.jsx(m,{item:!0,xs:12,children:e.jsx(M,{children:e.jsx(ae,{children:t.children})})})]})}const ot=Ee({topScrollPaper:{alignItems:"flex-start"},topPaperScrollBody:{verticalAlign:"top"}}),nt=t=>{const s=ot(),{refetchMedia:r,setOpen:a}=t,{loading:l}=he(g=>g.media),o=te(),{setError:u,handleSubmit:n,setValue:i}=o,x=xe(),c=()=>{a(!1)},j=g=>{g.parent_id=t.parentId,x(ge(g)).then(y=>{H(y,u),a(!1),i("name",""),r()}).catch(y=>{H(y,u)})};return e.jsx(Re,{open:t.open,onClose:c,"aria-labelledby":"form-dialog-title",scroll:"paper",maxWidth:"md",classes:{scrollPaper:s.topScrollPaper,paperScrollBody:s.topPaperScrollBody},sx:{"& .MuiDialog-container":{"& .MuiPaper-root":{width:"100%",maxWidth:"350px",marginTop:"100px"}}},children:e.jsxs("form",{noValidate:!0,onSubmit:n(j),children:[e.jsx(ze,{sx:{textAlign:"center",fontWeight:"bold"},children:"Make Folder"}),e.jsx(De,{children:e.jsx(W,{label:"Folder Name",name:"name",form:o,config:{rules:["required"]}})}),e.jsx(Ne,{children:e.jsxs(re,{children:[e.jsx(se,{loading:l,type:"submit",variant:"contained",color:"primary",startIcon:e.jsx(I,{children:"add"}),children:p("Add Folder")}),e.jsx(E,{variant:"contained",onClick:c,color:"secondary",children:"Close"})]})})]})})},ct=d.lazy(()=>q(()=>import("./ElementBuilder-BhrjtMtI.js").then(t=>t.a),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]))),lt=fe(d.lazy(()=>q(()=>import("./MediaDialog-DejNNsWp.js"),__vite__mapDeps([17,1,2,18,8]))));function dt({page:t,folder:s}){const[r,a]=d.useState(!1),[l,o]=d.useState(!1),[u,n]=d.useState(1),[i,x]=d.useState([]),[c,j]=d.useState(),[g,y]=d.useState({page:u,limit:30,parent_id:s,root:!s}),[D,k]=d.useState(),{data:S,refetch:$}=je(g);d.useEffect(()=>{S&&(x(i.concat(S==null?void 0:S.data)),c||j(S.meta))},[S]);const N=v=>{k(v[0])},_=v=>{n(v),y({...g,page:v})};return e.jsxs(d.Fragment,{children:[e.jsx(be,{in:r,children:e.jsx(M,{children:e.jsx(K,{folder:s,refetchMedia:$})})}),e.jsx(m,{container:!0,justifyContent:"flex-end",mt:3,children:e.jsxs(re,{children:[i&&i.length>0&&e.jsx(E,{type:"button",variant:"contained",color:"success",startIcon:e.jsx(I,{children:"cloud_upload"}),onClick:()=>a(!r),children:p("Upload")}),e.jsx(E,{type:"button",variant:"contained",color:"primary",startIcon:e.jsx(I,{children:"add"}),onClick:()=>o(!l),children:p("New Folder")})]})}),e.jsx(M,{sx:{mt:3},children:i&&c&&(i==null?void 0:i.length)>0?e.jsx(Fe,{pageStart:1,loadMore:_,hasMore:c.last_page>u,loader:e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",marginTop:"100px"},children:e.jsx(ve,{})}),children:e.jsx(m,{container:!0,spacing:2,children:i.map((v,b)=>e.jsx(m,{item:!0,xs:6,sm:3,md:2,lg:2,xl:2,children:e.jsx(Ae,{item:v,showAction:!0,goToFolder:!0,onChoose:N})},b))})}):e.jsx(m,{container:!0,spacing:2,children:e.jsx(m,{item:!0,xs:12,justifyContent:"center",children:e.jsx(K,{folder:s,refetchMedia:$})})})}),e.jsx(ct,{children:t.children||[]}),e.jsx(nt,{open:l,setOpen:o,parentId:s,refetchMedia:$}),e.jsx(lt,{selectedItem:D,setSelectedItem:k})]})}function pt({group:t,role:s,permissions:r,control:a,disabledAll:l,setValue:o}){const u=s&&s.permissions&&s.permissions.length===r.length||!1;return d.useState(u),e.jsxs(e.Fragment,{children:[e.jsxs(Q,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[e.jsx(w,{component:"th",scope:"row",colSpan:2,children:t.name}),e.jsx(w,{align:"center"})]},t.code),r&&r.map(n=>e.jsxs(Q,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[e.jsx(w,{component:"th",scope:"row",children:n.code}),e.jsxs(w,{align:"left",children:[n.name,e.jsx("br",{}),e.jsx(X,{sx:{color:"text.secondary",fontSize:"0.6rem"},children:n.description})]}),e.jsx(w,{align:"center",children:e.jsx(Be,{control:a,name:`permissions[${n.code}]`,defaultValue:s&&s.permissions&&s.permissions.filter(i=>i.code===n.code).length>0,render:({field:{onChange:i,onBlur:x,value:c}})=>e.jsx(ie,{value:c,checked:l||c,onBlur:x,onChange:i,disabled:l})})})]},n.code))]})}function mt({page:t}){var _,v;const[s,r]=d.useState(),[a,l]=d.useState(),[o,u]=d.useState(),[n,i]=d.useState(!1),x=te(),{control:c,register:j,setValue:g,setError:y,formState:{isLoading:D,errors:k},handleSubmit:S}=x,$=Se();if(d.useEffect(()=>{var b;(b=t.params)!=null&&b.id&&L.get(`/roles/${t.params.id}`).then(({data:f})=>{r(f.data),i(f.data.grant_all_permissions)}),a||L.get("/permissions/groups").then(({data:f})=>{l(f.data)}),o||L.get("/permissions").then(({data:f})=>{u(f.data)})},[t]),!a||!o||(_=t.params)!=null&&_.id&&!s)return e.jsx(Z,{});const N=b=>{var f,B;return b.grant_all_permissions=n,L.request({method:(f=t.params)!=null&&f.id?"PUT":"POST",url:(B=t.params)!=null&&B.id?`/roles/${t.params.id}`:"/roles",data:b}).then(T=>{T.data.success&&(ye(T.data.message,"success"),$("/admin-cp/roles"))}).catch(T=>{H(T,y)})};return e.jsxs("form",{noValidate:!0,onSubmit:S(N),children:[k&&e.jsx(Te,{errors:k,mb:2}),e.jsx(M,{title:p("Infomation"),children:e.jsxs(m,{container:!0,spacing:3,children:[e.jsx(m,{item:!0,md:6,children:e.jsx(W,{name:"name",label:p("Rule Name"),form:x,config:{rules:["required","max:100"]},defaultValue:s==null?void 0:s.name})}),e.jsx(m,{item:!0,md:6,children:e.jsx(W,{name:"code",label:p("Rule Code"),form:x,config:{rules:["required","max:50"]},defaultValue:s==null?void 0:s.code,disabled:!!((v=t.params)!=null&&v.id)})}),e.jsx(m,{item:!0,md:12,children:e.jsx(ie,{defaultChecked:n,onChange:()=>i(!n)})})]})}),e.jsx(M,{title:p("Permissions"),sx:{mt:3},children:e.jsx(m,{container:!0,spacing:3,children:e.jsx(m,{item:!0,md:12,children:e.jsx(Ve,{component:we,children:e.jsxs(Ue,{sx:{minWidth:650},"aria-label":"simple table",children:[e.jsx(Oe,{children:e.jsxs(Q,{children:[e.jsx(w,{align:"left",width:"20%",children:p("Permission")}),e.jsx(w,{align:"left",children:p("Description")}),e.jsx(w,{align:"center",width:"20%",children:p("Allow")})]})}),e.jsx(Ge,{children:a&&a.map(b=>{const f=o&&o.filter(B=>B.group===b.code);return f.length===0?null:e.jsx(pt,{group:b,permissions:f,role:s,control:c,setValue:g,register:j,disabledAll:n},b.code)})})]})})})})}),e.jsx(X,{sx:{display:"flex",justifyContent:"flex-end",mt:3},children:e.jsx(ee,{children:e.jsx(se,{type:"submit",variant:"contained",loading:D,startIcon:e.jsx(I,{children:"save"}),children:p("Save")})})})]})}function ut({page:t,uri:s}){return e.jsxs(m,{container:!0,spacing:2,children:[e.jsx(m,{item:!0,xs:12,md:3,children:e.jsx(X,{sx:{bgcolor:"background.paper"},children:e.jsxs(Ce,{component:"nav","aria-label":"main mailbox folders",subheader:e.jsx(Le,{component:"div",id:"nested-list-subheader",children:p("Profile")}),sx:{p:0,"& .MuiListItemIcon-root":{minWidth:32}},children:[e.jsxs(V,{component:F,to:U("profile"),selected:s==="profile",children:[e.jsx(O,{children:e.jsx(et,{})}),e.jsx(G,{primary:p("Profile")})]}),e.jsxs(V,{component:F,to:U("profile/change-password"),selected:s==="profile/change-password",children:[e.jsx(O,{children:e.jsx(tt,{})}),e.jsx(G,{primary:p("Change Password")})]}),e.jsxs(V,{component:F,to:U("profile/notifications"),selected:s==="profile/notifications",children:[e.jsx(O,{children:e.jsx(rt,{})}),e.jsx(G,{primary:p("Notifications")})]})]})})}),e.jsx(m,{item:!0,xs:12,md:9,children:e.jsx(ae,{children:t.children||[]})})]})}const ht=(t,s)=>{var r,a,l,o;switch(t.data.template){case"media":return e.jsx(dt,{page:t.data,...(r=t.data)==null?void 0:r.params});case"crud-index":return e.jsx(it,{page:t.data,uri:s,...(a=t.data)==null?void 0:a.params});case"role-form":return e.jsx(mt,{page:t.data,uri:s,...(l=t.data)==null?void 0:l.params});case"profile":return e.jsx(ut,{page:t.data,uri:s,...(o=t.data)==null?void 0:o.params})}return e.jsx(A,{})},xt=(t,s)=>{switch(t.data.template){default:return ht(t,s)}},gt=xt,ft=d.lazy(()=>q(()=>import("./ElementBuilder-BhrjtMtI.js").then(t=>t.a),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16])));function Ut(){var x,c;const t=ke(),s=$e(Pe.getState()),r=t["*"]||"",{data:a,error:l,refetch:o,isLoading:u,isFetching:n}=Ie(r);return z.useEffect(()=>{o()},[r,o]),(!a||(u||n))&&!l?e.jsx(Z,{}):l?e.jsx(A,{}):a.success?((x=a.permissions)==null?void 0:x.length)>0&&(!s||s&&!Me(s,a.permissions))?e.jsx(A,{title:p("Access Denied")}):e.jsx(_e,{title:a.data.title,description:a.data.description,breadcrumbs:a.data.breadcrumbs,showTitle:a.data.show_title,children:(c=a.data)!=null&&c.template?gt(a,r):e.jsx(ft,{children:a.data.children||[]})}):e.jsx(A,{})}export{Ut as default};
