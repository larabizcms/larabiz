import{r as c,X as j,aX as H,bg as T,b6 as C,aq as A,j as O,a8 as _,p as z}from"./index-C7XDJ_kP.js";const N=["actions","autoFocus","autoFocusItem","children","className","disabledItemsFocusable","disableListWrap","onKeyDown","variant"];function w(n,t,r){return n===t?n.firstChild:t&&t.nextElementSibling?t.nextElementSibling:r?null:n.firstChild}function D(n,t,r){return n===t?r?n.firstChild:n.lastChild:t&&t.previousElementSibling?t.previousElementSibling:r?null:n.lastChild}function I(n,t){if(t===void 0)return!0;let r=n.innerText;return r===void 0&&(r=n.textContent),r=r.trim().toLowerCase(),r.length===0?!1:t.repeating?r[0]===t.keys[0]:r.indexOf(t.keys.join(""))===0}function g(n,t,r,b,h,y){let d=!1,a=h(n,t,t?r:!1);for(;a;){if(a===n.firstChild){if(d)return!1;d=!0}const p=b?!1:a.disabled||a.getAttribute("aria-disabled")==="true";if(!a.hasAttribute("tabindex")||!I(a,y)||p)a=h(n,a,r);else return a.focus(),!0}return!1}const W=c.forwardRef(function(t,r){const{actions:b,autoFocus:h=!1,autoFocusItem:y=!1,children:d,className:a,disabledItemsFocusable:p=!1,disableListWrap:m=!1,onKeyDown:x,variant:v="selectedMenu"}=t,F=j(t,N),u=c.useRef(null),M=c.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});H(()=>{h&&u.current.focus()},[h]),c.useImperativeHandle(b,()=>({adjustStyleForScrollbar:(e,{direction:s})=>{const o=!u.current.style.width;if(e.clientHeight<u.current.clientHeight&&o){const f=`${T(C(e))}px`;u.current.style[s==="rtl"?"paddingLeft":"paddingRight"]=f,u.current.style.width=`calc(100% + ${f})`}return u.current}}),[]);const S=e=>{const s=u.current,o=e.key,f=C(s).activeElement;if(o==="ArrowDown")e.preventDefault(),g(s,f,m,p,w);else if(o==="ArrowUp")e.preventDefault(),g(s,f,m,p,D);else if(o==="Home")e.preventDefault(),g(s,null,m,p,w);else if(o==="End")e.preventDefault(),g(s,null,m,p,D);else if(o.length===1){const i=M.current,k=o.toLowerCase(),E=performance.now();i.keys.length>0&&(E-i.lastTime>500?(i.keys=[],i.repeating=!0,i.previousKeyMatched=!0):i.repeating&&k!==i.keys[0]&&(i.repeating=!1)),i.lastTime=E,i.keys.push(k);const R=f&&!i.repeating&&I(f,i);i.previousKeyMatched&&(R||g(s,f,!1,p,w,i))?e.preventDefault():i.previousKeyMatched=!1}x&&x(e)},K=A(u,r);let l=-1;c.Children.forEach(d,(e,s)=>{if(!c.isValidElement(e)){l===s&&(l+=1,l>=d.length&&(l=-1));return}e.props.disabled||(v==="selectedMenu"&&e.props.selected||l===-1)&&(l=s),l===s&&(e.props.disabled||e.props.muiSkipListHighlight||e.type.muiSkipListHighlight)&&(l+=1,l>=d.length&&(l=-1))});const L=c.Children.map(d,(e,s)=>{if(s===l){const o={};return y&&(o.autoFocus=!0),e.props.tabIndex===void 0&&v==="selectedMenu"&&(o.tabIndex=0),c.cloneElement(e,o)}return e});return O.jsx(_,z({role:"menu",ref:K,className:a,onKeyDown:S,tabIndex:h?0:-1},F,{children:L}))});export{W as M};
