var Or=Object.defineProperty;var Cr=(e,r,t)=>r in e?Or(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t;var De=(e,r,t)=>Cr(e,typeof r!="symbol"?r+"":r,t);import{d as Pr,j as S,aO as _r,C as Fe,T as se,aF as g,r as y,R as Se,k as Tr,I as Sr,E as jr,bQ as Lr,o as xe,F as we,ax as Ue}from"./index-C7XDJ_kP.js";import{M as kr,C as Rr}from"./MediaPreview-Cap6zzTb.js";import{b as Z,c as J,d as Ne,e as Ye}from"./tslib.es6-4OAZryUH.js";const Ir=({item:e,goToFolder:r,setSelectedItems:t,selectedItems:n,multipleSelect:i=!1,onChoose:c,onGoToFolder:p})=>{const o=Pr(),m=()=>{if(e.is_directory&&r){o("/admin-cp/media/"+e.id);return}if(e.is_directory){p&&p(e);return}t&&!i&&t([e]),c&&!i&&c([e]),t&&i&&(n&&n.find(s=>s.id===e.id)?t(n.filter(s=>s.id!==e.id)):t(n?[...n,e]:[e]))};return S.jsxs(_r,{sx:{position:"relative"},children:[S.jsx(kr,{media:e,handleClickItem:m,selectedItems:n}),S.jsx(Fe,{sx:{padding:"10px 5px"},children:S.jsx(se,{variant:"subtitle1",component:"div",sx:{display:"-webkit-box",overflow:"hidden",WebkitBoxOrient:"vertical",WebkitLineClamp:1},children:e.name})})]})},Ht=Ir;var Mr=new Map([["aac","audio/aac"],["abw","application/x-abiword"],["arc","application/x-freearc"],["avif","image/avif"],["avi","video/x-msvideo"],["azw","application/vnd.amazon.ebook"],["bin","application/octet-stream"],["bmp","image/bmp"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["cda","application/x-cdf"],["csh","application/x-csh"],["css","text/css"],["csv","text/csv"],["doc","application/msword"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["eot","application/vnd.ms-fontobject"],["epub","application/epub+zip"],["gz","application/gzip"],["gif","image/gif"],["heic","image/heic"],["heif","image/heif"],["htm","text/html"],["html","text/html"],["ico","image/vnd.microsoft.icon"],["ics","text/calendar"],["jar","application/java-archive"],["jpeg","image/jpeg"],["jpg","image/jpeg"],["js","text/javascript"],["json","application/json"],["jsonld","application/ld+json"],["mid","audio/midi"],["midi","audio/midi"],["mjs","text/javascript"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mpeg","video/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["opus","audio/opus"],["otf","font/otf"],["png","image/png"],["pdf","application/pdf"],["php","application/x-httpd-php"],["ppt","application/vnd.ms-powerpoint"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["rar","application/vnd.rar"],["rtf","application/rtf"],["sh","application/x-sh"],["svg","image/svg+xml"],["swf","application/x-shockwave-flash"],["tar","application/x-tar"],["tif","image/tiff"],["tiff","image/tiff"],["ts","video/mp2t"],["ttf","font/ttf"],["txt","text/plain"],["vsd","application/vnd.visio"],["wav","audio/wav"],["weba","audio/webm"],["webm","video/webm"],["webp","image/webp"],["woff","font/woff"],["woff2","font/woff2"],["xhtml","application/xhtml+xml"],["xls","application/vnd.ms-excel"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xml","application/xml"],["xul","application/vnd.mozilla.xul+xml"],["zip","application/zip"],["7z","application/x-7z-compressed"],["mkv","video/x-matroska"],["mov","video/quicktime"],["msg","application/vnd.ms-outlook"]]);function X(e,r){var t=zr(e);if(typeof t.path!="string"){var n=e.webkitRelativePath;Object.defineProperty(t,"path",{value:typeof r=="string"?r:typeof n=="string"&&n.length>0?n:e.name,writable:!1,configurable:!1,enumerable:!0})}return t}function zr(e){var r=e.name,t=r&&r.lastIndexOf(".")!==-1;if(t&&!e.type){var n=r.split(".").pop().toLowerCase(),i=Mr.get(n);i&&Object.defineProperty(e,"type",{value:i,writable:!1,configurable:!1,enumerable:!0})}return e}var Br=[".DS_Store","Thumbs.db"];function Hr(e){return Z(this,void 0,void 0,function(){return J(this,function(r){return ue(e)&&Wr(e.dataTransfer)?[2,Nr(e.dataTransfer,e.type)]:$r(e)?[2,Kr(e)]:Array.isArray(e)&&e.every(function(t){return"getFile"in t&&typeof t.getFile=="function"})?[2,Ur(e)]:[2,[]]})})}function Wr(e){return ue(e)}function $r(e){return ue(e)&&ue(e.target)}function ue(e){return typeof e=="object"&&e!==null}function Kr(e){return Ae(e.target.files).map(function(r){return X(r)})}function Ur(e){return Z(this,void 0,void 0,function(){var r;return J(this,function(t){switch(t.label){case 0:return[4,Promise.all(e.map(function(n){return n.getFile()}))];case 1:return r=t.sent(),[2,r.map(function(n){return X(n)})]}})})}function Nr(e,r){return Z(this,void 0,void 0,function(){var t,n;return J(this,function(i){switch(i.label){case 0:return e.items?(t=Ae(e.items).filter(function(c){return c.kind==="file"}),r!=="drop"?[2,t]:[4,Promise.all(t.map(Yr))]):[3,2];case 1:return n=i.sent(),[2,Ge(ar(n))];case 2:return[2,Ge(Ae(e.files).map(function(c){return X(c)}))]}})})}function Ge(e){return e.filter(function(r){return Br.indexOf(r.name)===-1})}function Ae(e){if(e===null)return[];for(var r=[],t=0;t<e.length;t++){var n=e[t];r.push(n)}return r}function Yr(e){if(typeof e.webkitGetAsEntry!="function")return qe(e);var r=e.webkitGetAsEntry();return r&&r.isDirectory?sr(r):qe(e)}function ar(e){return e.reduce(function(r,t){return Ne(Ne([],Ye(r),!1),Ye(Array.isArray(t)?ar(t):[t]),!1)},[])}function qe(e){var r=e.getAsFile();if(!r)return Promise.reject("".concat(e," is not a File"));var t=X(r);return Promise.resolve(t)}function Gr(e){return Z(this,void 0,void 0,function(){return J(this,function(r){return[2,e.isDirectory?sr(e):qr(e)]})})}function sr(e){var r=e.createReader();return new Promise(function(t,n){var i=[];function c(){var p=this;r.readEntries(function(o){return Z(p,void 0,void 0,function(){var m,s,a;return J(this,function(u){switch(u.label){case 0:if(o.length)return[3,5];u.label=1;case 1:return u.trys.push([1,3,,4]),[4,Promise.all(i)];case 2:return m=u.sent(),t(m),[3,4];case 3:return s=u.sent(),n(s),[3,4];case 4:return[3,6];case 5:a=Promise.all(o.map(Gr)),i.push(a),c(),u.label=6;case 6:return[2]}})})},function(o){n(o)})}c()})}function qr(e){return Z(this,void 0,void 0,function(){return J(this,function(r){return[2,new Promise(function(t,n){e.file(function(i){var c=X(i,e.fullPath);t(c)},function(i){n(i)})})]})})}var Zr=function(e,r){if(e&&r){var t=Array.isArray(r)?r:r.split(","),n=e.name||"",i=(e.type||"").toLowerCase(),c=i.replace(/\/.*$/,"");return t.some(function(p){var o=p.trim().toLowerCase();return o.charAt(0)==="."?n.toLowerCase().endsWith(o):o.endsWith("/*")?c===o.replace(/\/.*$/,""):i===o})}return!0};function Ze(e){return Vr(e)||Qr(e)||lr(e)||Jr()}function Jr(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qr(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Vr(e){if(Array.isArray(e))return Oe(e)}function Je(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function Qe(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Je(Object(t),!0).forEach(function(n){ur(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Je(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function ur(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function V(e,r){return rt(e)||et(e,r)||lr(e,r)||Xr()}function Xr(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lr(e,r){if(e){if(typeof e=="string")return Oe(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Oe(e,r)}}function Oe(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function et(e,r){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var n=[],i=!0,c=!1,p,o;try{for(t=t.call(e);!(i=(p=t.next()).done)&&(n.push(p.value),!(r&&n.length===r));i=!0);}catch(m){c=!0,o=m}finally{try{!i&&t.return!=null&&t.return()}finally{if(c)throw o}}return n}}function rt(e){if(Array.isArray(e))return e}var tt="file-invalid-type",nt="file-too-large",ot="file-too-small",it="too-many-files",at=function(r){r=Array.isArray(r)&&r.length===1?r[0]:r;var t=Array.isArray(r)?"one of ".concat(r.join(", ")):r;return{code:tt,message:"File type must be ".concat(t)}},Ve=function(r){return{code:nt,message:"File is larger than ".concat(r," ").concat(r===1?"byte":"bytes")}},Xe=function(r){return{code:ot,message:"File is smaller than ".concat(r," ").concat(r===1?"byte":"bytes")}},st={code:it,message:"Too many files"};function cr(e,r){var t=e.type==="application/x-moz-file"||Zr(e,r);return[t,t?null:at(r)]}function fr(e,r,t){if(K(e.size))if(K(r)&&K(t)){if(e.size>t)return[!1,Ve(t)];if(e.size<r)return[!1,Xe(r)]}else{if(K(r)&&e.size<r)return[!1,Xe(r)];if(K(t)&&e.size>t)return[!1,Ve(t)]}return[!0,null]}function K(e){return e!=null}function ut(e){var r=e.files,t=e.accept,n=e.minSize,i=e.maxSize,c=e.multiple,p=e.maxFiles,o=e.validator;return!c&&r.length>1||c&&p>=1&&r.length>p?!1:r.every(function(m){var s=cr(m,t),a=V(s,1),u=a[0],l=fr(m,n,i),f=V(l,1),x=f[0],D=o?o(m):null;return u&&x&&!D})}function le(e){return typeof e.isPropagationStopped=="function"?e.isPropagationStopped():typeof e.cancelBubble<"u"?e.cancelBubble:!1}function ae(e){return e.dataTransfer?Array.prototype.some.call(e.dataTransfer.types,function(r){return r==="Files"||r==="application/x-moz-file"}):!!e.target&&!!e.target.files}function er(e){e.preventDefault()}function lt(e){return e.indexOf("MSIE")!==-1||e.indexOf("Trident/")!==-1}function ct(e){return e.indexOf("Edge/")!==-1}function ft(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return lt(e)||ct(e)}function I(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return function(n){for(var i=arguments.length,c=new Array(i>1?i-1:0),p=1;p<i;p++)c[p-1]=arguments[p];return r.some(function(o){return!le(n)&&o&&o.apply(void 0,[n].concat(c)),le(n)})}}function pt(){return"showOpenFilePicker"in window}function dt(e){if(K(e)){var r=Object.entries(e).filter(function(t){var n=V(t,2),i=n[0],c=n[1],p=!0;return pr(i)||(console.warn('Skipped "'.concat(i,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),p=!1),(!Array.isArray(c)||!c.every(dr))&&(console.warn('Skipped "'.concat(i,'" because an invalid file extension was provided.')),p=!1),p}).reduce(function(t,n){var i=V(n,2),c=i[0],p=i[1];return Qe(Qe({},t),{},ur({},c,p))},{});return[{description:"Files",accept:r}]}return e}function ht(e){if(K(e))return Object.entries(e).reduce(function(r,t){var n=V(t,2),i=n[0],c=n[1];return[].concat(Ze(r),[i],Ze(c))},[]).filter(function(r){return pr(r)||dr(r)}).join(",")}function gt(e){return e instanceof DOMException&&(e.name==="AbortError"||e.code===e.ABORT_ERR)}function mt(e){return e instanceof DOMException&&(e.name==="SecurityError"||e.code===e.SECURITY_ERR)}function pr(e){return e==="audio/*"||e==="video/*"||e==="image/*"||e==="text/*"||/\w+\/[-+.\w]+/g.test(e)}function dr(e){return/^.*\.[\w]+$/.test(e)}var vt=["children"],yt=["open"],bt=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],Dt=["refKey","onChange","onClick"];function xt(e){return Ft(e)||Et(e)||hr(e)||wt()}function wt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Et(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ft(e){if(Array.isArray(e))return Ce(e)}function Ee(e,r){return Ct(e)||Ot(e,r)||hr(e,r)||At()}function At(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hr(e,r){if(e){if(typeof e=="string")return Ce(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Ce(e,r)}}function Ce(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function Ot(e,r){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var n=[],i=!0,c=!1,p,o;try{for(t=t.call(e);!(i=(p=t.next()).done)&&(n.push(p.value),!(r&&n.length===r));i=!0);}catch(m){c=!0,o=m}finally{try{!i&&t.return!=null&&t.return()}finally{if(c)throw o}}return n}}function Ct(e){if(Array.isArray(e))return e}function rr(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function E(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?rr(Object(t),!0).forEach(function(n){Pe(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):rr(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Pe(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function ce(e,r){if(e==null)return{};var t=Pt(e,r),n,i;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(i=0;i<c.length;i++)n=c[i],!(r.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(t[n]=e[n])}return t}function Pt(e,r){if(e==null)return{};var t={},n=Object.keys(e),i,c;for(c=0;c<n.length;c++)i=n[c],!(r.indexOf(i)>=0)&&(t[i]=e[i]);return t}var je=y.forwardRef(function(e,r){var t=e.children,n=ce(e,vt),i=mr(n),c=i.open,p=ce(i,yt);return y.useImperativeHandle(r,function(){return{open:c}},[c]),Se.createElement(y.Fragment,null,t(E(E({},p),{},{open:c})))});je.displayName="Dropzone";var gr={disabled:!1,getFilesFromEvent:Hr,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!0,autoFocus:!1};je.defaultProps=gr;je.propTypes={children:g.func,accept:g.objectOf(g.arrayOf(g.string)),multiple:g.bool,preventDropOnDocument:g.bool,noClick:g.bool,noKeyboard:g.bool,noDrag:g.bool,noDragEventsBubbling:g.bool,minSize:g.number,maxSize:g.number,maxFiles:g.number,disabled:g.bool,getFilesFromEvent:g.func,onFileDialogCancel:g.func,onFileDialogOpen:g.func,useFsAccessApi:g.bool,autoFocus:g.bool,onDragEnter:g.func,onDragLeave:g.func,onDragOver:g.func,onDrop:g.func,onDropAccepted:g.func,onDropRejected:g.func,onError:g.func,validator:g.func};var _e={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function mr(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=E(E({},gr),e),t=r.accept,n=r.disabled,i=r.getFilesFromEvent,c=r.maxSize,p=r.minSize,o=r.multiple,m=r.maxFiles,s=r.onDragEnter,a=r.onDragLeave,u=r.onDragOver,l=r.onDrop,f=r.onDropAccepted,x=r.onDropRejected,D=r.onFileDialogCancel,b=r.onFileDialogOpen,w=r.useFsAccessApi,v=r.autoFocus,F=r.preventDropOnDocument,P=r.noClick,j=r.noKeyboard,B=r.noDrag,O=r.noDragEventsBubbling,T=r.onError,H=r.validator,M=y.useMemo(function(){return ht(t)},[t]),z=y.useMemo(function(){return dt(t)},[t]),W=y.useMemo(function(){return typeof b=="function"?b:tr},[b]),U=y.useMemo(function(){return typeof D=="function"?D:tr},[D]),_=y.useRef(null),R=y.useRef(null),Dr=y.useReducer(_t,_e),Le=Ee(Dr,2),fe=Le[0],L=Le[1],xr=fe.isFocused,ke=fe.isFileDialogActive,ee=y.useRef(typeof window<"u"&&window.isSecureContext&&w&&pt()),Re=function(){!ee.current&&ke&&setTimeout(function(){if(R.current){var h=R.current.files;h.length||(L({type:"closeDialog"}),U())}},300)};y.useEffect(function(){return window.addEventListener("focus",Re,!1),function(){window.removeEventListener("focus",Re,!1)}},[R,ke,U,ee]);var N=y.useRef([]),Ie=function(h){_.current&&_.current.contains(h.target)||(h.preventDefault(),N.current=[])};y.useEffect(function(){return F&&(document.addEventListener("dragover",er,!1),document.addEventListener("drop",Ie,!1)),function(){F&&(document.removeEventListener("dragover",er),document.removeEventListener("drop",Ie))}},[_,F]),y.useEffect(function(){return!n&&v&&_.current&&_.current.focus(),function(){}},[_,v,n]);var $=y.useCallback(function(d){T?T(d):console.error(d)},[T]),Me=y.useCallback(function(d){d.preventDefault(),d.persist(),oe(d),N.current=[].concat(xt(N.current),[d.target]),ae(d)&&Promise.resolve(i(d)).then(function(h){if(!(le(d)&&!O)){var A=h.length,C=A>0&&ut({files:h,accept:M,minSize:p,maxSize:c,multiple:o,maxFiles:m,validator:H}),k=A>0&&!C;L({isDragAccept:C,isDragReject:k,isDragActive:!0,type:"setDraggedFiles"}),s&&s(d)}}).catch(function(h){return $(h)})},[i,s,$,O,M,p,c,o,m,H]),ze=y.useCallback(function(d){d.preventDefault(),d.persist(),oe(d);var h=ae(d);if(h&&d.dataTransfer)try{d.dataTransfer.dropEffect="copy"}catch{}return h&&u&&u(d),!1},[u,O]),Be=y.useCallback(function(d){d.preventDefault(),d.persist(),oe(d);var h=N.current.filter(function(C){return _.current&&_.current.contains(C)}),A=h.indexOf(d.target);A!==-1&&h.splice(A,1),N.current=h,!(h.length>0)&&(L({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),ae(d)&&a&&a(d))},[_,a,O]),re=y.useCallback(function(d,h){var A=[],C=[];d.forEach(function(k){var Q=cr(k,M),q=Ee(Q,2),de=q[0],he=q[1],ge=fr(k,p,c),ie=Ee(ge,2),me=ie[0],ve=ie[1],ye=H?H(k):null;if(de&&me&&!ye)A.push(k);else{var be=[he,ve];ye&&(be=be.concat(ye)),C.push({file:k,errors:be.filter(function(Ar){return Ar})})}}),(!o&&A.length>1||o&&m>=1&&A.length>m)&&(A.forEach(function(k){C.push({file:k,errors:[st]})}),A.splice(0)),L({acceptedFiles:A,fileRejections:C,type:"setFiles"}),l&&l(A,C,h),C.length>0&&x&&x(C,h),A.length>0&&f&&f(A,h)},[L,o,M,p,c,m,l,f,x,H]),te=y.useCallback(function(d){d.preventDefault(),d.persist(),oe(d),N.current=[],ae(d)&&Promise.resolve(i(d)).then(function(h){le(d)&&!O||re(h,d)}).catch(function(h){return $(h)}),L({type:"reset"})},[i,re,$,O]),Y=y.useCallback(function(){if(ee.current){L({type:"openDialog"}),W();var d={multiple:o,types:z};window.showOpenFilePicker(d).then(function(h){return i(h)}).then(function(h){re(h,null),L({type:"closeDialog"})}).catch(function(h){gt(h)?(U(h),L({type:"closeDialog"})):mt(h)?(ee.current=!1,R.current?(R.current.value=null,R.current.click()):$(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):$(h)});return}R.current&&(L({type:"openDialog"}),W(),R.current.value=null,R.current.click())},[L,W,U,w,re,$,z,o]),He=y.useCallback(function(d){!_.current||!_.current.isEqualNode(d.target)||(d.key===" "||d.key==="Enter"||d.keyCode===32||d.keyCode===13)&&(d.preventDefault(),Y())},[_,Y]),We=y.useCallback(function(){L({type:"focus"})},[]),$e=y.useCallback(function(){L({type:"blur"})},[]),Ke=y.useCallback(function(){P||(ft()?setTimeout(Y,0):Y())},[P,Y]),G=function(h){return n?null:h},pe=function(h){return j?null:G(h)},ne=function(h){return B?null:G(h)},oe=function(h){O&&h.stopPropagation()},wr=y.useMemo(function(){return function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},h=d.refKey,A=h===void 0?"ref":h,C=d.role,k=d.onKeyDown,Q=d.onFocus,q=d.onBlur,de=d.onClick,he=d.onDragEnter,ge=d.onDragOver,ie=d.onDragLeave,me=d.onDrop,ve=ce(d,bt);return E(E(Pe({onKeyDown:pe(I(k,He)),onFocus:pe(I(Q,We)),onBlur:pe(I(q,$e)),onClick:G(I(de,Ke)),onDragEnter:ne(I(he,Me)),onDragOver:ne(I(ge,ze)),onDragLeave:ne(I(ie,Be)),onDrop:ne(I(me,te)),role:typeof C=="string"&&C!==""?C:"presentation"},A,_),!n&&!j?{tabIndex:0}:{}),ve)}},[_,He,We,$e,Ke,Me,ze,Be,te,j,B,n]),Er=y.useCallback(function(d){d.stopPropagation()},[]),Fr=y.useMemo(function(){return function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},h=d.refKey,A=h===void 0?"ref":h,C=d.onChange,k=d.onClick,Q=ce(d,Dt),q=Pe({accept:M,multiple:o,type:"file",style:{display:"none"},onChange:G(I(C,te)),onClick:G(I(k,Er)),tabIndex:-1},A,R);return E(E({},q),Q)}},[R,t,o,te,n]);return E(E({},fe),{},{isFocused:xr&&!n,getRootProps:wr,getInputProps:Fr,rootRef:_,inputRef:R,open:G(Y)})}function _t(e,r){switch(r.type){case"focus":return E(E({},e),{},{isFocused:!0});case"blur":return E(E({},e),{},{isFocused:!1});case"openDialog":return E(E({},_e),{},{isFileDialogActive:!0});case"closeDialog":return E(E({},e),{},{isFileDialogActive:!1});case"setDraggedFiles":return E(E({},e),{},{isDragActive:r.isDragActive,isDragAccept:r.isDragAccept,isDragReject:r.isDragReject});case"setFiles":return E(E({},e),{},{acceptedFiles:r.acceptedFiles,fileRejections:r.fileRejections});case"reset":return E({},_e);default:return e}}function tr(){}var vr={exports:{}},yr={exports:{}};(function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r={rotl:function(t,n){return t<<n|t>>>32-n},rotr:function(t,n){return t<<32-n|t>>>n},endian:function(t){if(t.constructor==Number)return r.rotl(t,8)&16711935|r.rotl(t,24)&4278255360;for(var n=0;n<t.length;n++)t[n]=r.endian(t[n]);return t},randomBytes:function(t){for(var n=[];t>0;t--)n.push(Math.floor(Math.random()*256));return n},bytesToWords:function(t){for(var n=[],i=0,c=0;i<t.length;i++,c+=8)n[c>>>5]|=t[i]<<24-c%32;return n},wordsToBytes:function(t){for(var n=[],i=0;i<t.length*32;i+=8)n.push(t[i>>>5]>>>24-i%32&255);return n},bytesToHex:function(t){for(var n=[],i=0;i<t.length;i++)n.push((t[i]>>>4).toString(16)),n.push((t[i]&15).toString(16));return n.join("")},hexToBytes:function(t){for(var n=[],i=0;i<t.length;i+=2)n.push(parseInt(t.substr(i,2),16));return n},bytesToBase64:function(t){for(var n=[],i=0;i<t.length;i+=3)for(var c=t[i]<<16|t[i+1]<<8|t[i+2],p=0;p<4;p++)i*8+p*6<=t.length*8?n.push(e.charAt(c>>>6*(3-p)&63)):n.push("=");return n.join("")},base64ToBytes:function(t){t=t.replace(/[^A-Z0-9+\/]/ig,"");for(var n=[],i=0,c=0;i<t.length;c=++i%4)c!=0&&n.push((e.indexOf(t.charAt(i-1))&Math.pow(2,-2*c+8)-1)<<c*2|e.indexOf(t.charAt(i))>>>6-c*2);return n}};yr.exports=r})();var Tt=yr.exports,Te={utf8:{stringToBytes:function(e){return Te.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(Te.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var r=[],t=0;t<e.length;t++)r.push(e.charCodeAt(t)&255);return r},bytesToString:function(e){for(var r=[],t=0;t<e.length;t++)r.push(String.fromCharCode(e[t]));return r.join("")}}},nr=Te;/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var St=function(e){return e!=null&&(br(e)||jt(e)||!!e._isBuffer)};function br(e){return!!e.constructor&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}function jt(e){return typeof e.readFloatLE=="function"&&typeof e.slice=="function"&&br(e.slice(0,0))}(function(){var e=Tt,r=nr.utf8,t=St,n=nr.bin,i=function(c,p){c.constructor==String?p&&p.encoding==="binary"?c=n.stringToBytes(c):c=r.stringToBytes(c):t(c)?c=Array.prototype.slice.call(c,0):!Array.isArray(c)&&c.constructor!==Uint8Array&&(c=c.toString());for(var o=e.bytesToWords(c),m=c.length*8,s=1732584193,a=-271733879,u=-1732584194,l=271733878,f=0;f<o.length;f++)o[f]=(o[f]<<8|o[f]>>>24)&16711935|(o[f]<<24|o[f]>>>8)&4278255360;o[m>>>5]|=128<<m%32,o[(m+64>>>9<<4)+14]=m;for(var x=i._ff,D=i._gg,b=i._hh,w=i._ii,f=0;f<o.length;f+=16){var v=s,F=a,P=u,j=l;s=x(s,a,u,l,o[f+0],7,-680876936),l=x(l,s,a,u,o[f+1],12,-389564586),u=x(u,l,s,a,o[f+2],17,606105819),a=x(a,u,l,s,o[f+3],22,-1044525330),s=x(s,a,u,l,o[f+4],7,-176418897),l=x(l,s,a,u,o[f+5],12,1200080426),u=x(u,l,s,a,o[f+6],17,-1473231341),a=x(a,u,l,s,o[f+7],22,-45705983),s=x(s,a,u,l,o[f+8],7,1770035416),l=x(l,s,a,u,o[f+9],12,-1958414417),u=x(u,l,s,a,o[f+10],17,-42063),a=x(a,u,l,s,o[f+11],22,-1990404162),s=x(s,a,u,l,o[f+12],7,1804603682),l=x(l,s,a,u,o[f+13],12,-40341101),u=x(u,l,s,a,o[f+14],17,-1502002290),a=x(a,u,l,s,o[f+15],22,1236535329),s=D(s,a,u,l,o[f+1],5,-165796510),l=D(l,s,a,u,o[f+6],9,-1069501632),u=D(u,l,s,a,o[f+11],14,643717713),a=D(a,u,l,s,o[f+0],20,-373897302),s=D(s,a,u,l,o[f+5],5,-701558691),l=D(l,s,a,u,o[f+10],9,38016083),u=D(u,l,s,a,o[f+15],14,-660478335),a=D(a,u,l,s,o[f+4],20,-405537848),s=D(s,a,u,l,o[f+9],5,568446438),l=D(l,s,a,u,o[f+14],9,-1019803690),u=D(u,l,s,a,o[f+3],14,-187363961),a=D(a,u,l,s,o[f+8],20,1163531501),s=D(s,a,u,l,o[f+13],5,-1444681467),l=D(l,s,a,u,o[f+2],9,-51403784),u=D(u,l,s,a,o[f+7],14,1735328473),a=D(a,u,l,s,o[f+12],20,-1926607734),s=b(s,a,u,l,o[f+5],4,-378558),l=b(l,s,a,u,o[f+8],11,-2022574463),u=b(u,l,s,a,o[f+11],16,1839030562),a=b(a,u,l,s,o[f+14],23,-35309556),s=b(s,a,u,l,o[f+1],4,-1530992060),l=b(l,s,a,u,o[f+4],11,1272893353),u=b(u,l,s,a,o[f+7],16,-155497632),a=b(a,u,l,s,o[f+10],23,-1094730640),s=b(s,a,u,l,o[f+13],4,681279174),l=b(l,s,a,u,o[f+0],11,-358537222),u=b(u,l,s,a,o[f+3],16,-722521979),a=b(a,u,l,s,o[f+6],23,76029189),s=b(s,a,u,l,o[f+9],4,-640364487),l=b(l,s,a,u,o[f+12],11,-421815835),u=b(u,l,s,a,o[f+15],16,530742520),a=b(a,u,l,s,o[f+2],23,-995338651),s=w(s,a,u,l,o[f+0],6,-198630844),l=w(l,s,a,u,o[f+7],10,1126891415),u=w(u,l,s,a,o[f+14],15,-1416354905),a=w(a,u,l,s,o[f+5],21,-57434055),s=w(s,a,u,l,o[f+12],6,1700485571),l=w(l,s,a,u,o[f+3],10,-1894986606),u=w(u,l,s,a,o[f+10],15,-1051523),a=w(a,u,l,s,o[f+1],21,-2054922799),s=w(s,a,u,l,o[f+8],6,1873313359),l=w(l,s,a,u,o[f+15],10,-30611744),u=w(u,l,s,a,o[f+6],15,-1560198380),a=w(a,u,l,s,o[f+13],21,1309151649),s=w(s,a,u,l,o[f+4],6,-145523070),l=w(l,s,a,u,o[f+11],10,-1120210379),u=w(u,l,s,a,o[f+2],15,718787259),a=w(a,u,l,s,o[f+9],21,-343485551),s=s+v>>>0,a=a+F>>>0,u=u+P>>>0,l=l+j>>>0}return e.endian([s,a,u,l])};i._ff=function(c,p,o,m,s,a,u){var l=c+(p&o|~p&m)+(s>>>0)+u;return(l<<a|l>>>32-a)+p},i._gg=function(c,p,o,m,s,a,u){var l=c+(p&m|o&~m)+(s>>>0)+u;return(l<<a|l>>>32-a)+p},i._hh=function(c,p,o,m,s,a,u){var l=c+(p^o^m)+(s>>>0)+u;return(l<<a|l>>>32-a)+p},i._ii=function(c,p,o,m,s,a,u){var l=c+(o^(p|~m))+(s>>>0)+u;return(l<<a|l>>>32-a)+p},i._blocksize=16,i._digestsize=16,vr.exports=function(c,p){if(c==null)throw new Error("Illegal argument "+c);var o=e.wordsToBytes(i(c,p));return p&&p.asBytes?o:p&&p.asString?n.bytesToString(o):e.bytesToHex(o)}})();var Lt=vr.exports;const kt=Tr(Lt),or=1048576,Rt=({refetchMedia:e,accept:r,folder:t,onUploadSuccess:n,setData:i,setMeta:c})=>{const[p,o]=y.useState(),[m,s]=y.useState("pending");Se.useEffect(()=>{m==="success"&&(i&&i([]),c&&c(void 0),e&&e(),n&&n(),s("pending"))},[m]);const a=v=>kt(v.name),u=()=>{(!p||p.filter(v=>!(v!=null&&v.error)).length===0)&&s("success")},l=(v,F)=>{o(P=>P==null?void 0:P.map(j=>(j.hash===a(v)&&(j.error=F),j)))},f=async(v,F,P,j,B)=>{const O=v.slice(F,P),T=new FormData;T.append("file",O,v.name),T.append("hash",a(v)),T.append("index",j.toString()),T.append("token",B),await xe.post(we+"/media/upload/chunk",T,{onUploadProgress:H=>{const M=Math.round(100*H.loaded/H.total);o(z=>{if(z){const W=z.findIndex(U=>U.hash===a(v));return W!==-1?(z[W]={...z[W],progress:M},[...z]):[...z,{name:v.name,progress:M,hash:a(v)}]}else return[{name:v.name,progress:M,hash:a(v)}]})}})},x=async v=>{s("uploading"),v.forEach(async F=>{xe.post(we+"/media/upload/create",{filename:F.name,mimetype:a(F),size:F.size,disk:"public",parent_id:t||null}).then(async({data:P})=>{const j=Math.ceil(F.size/or);let B=0;for(let O=0;O<j;O++){const T=B+or;await f(F,B,T,O,P.data.token),B=T}await xe.post(we+"/media/upload/combine",{filename:F.name,hash:a(F),token:P.data.token}).then(()=>{o(O=>O==null?void 0:O.filter(T=>T.hash!==a(F))),u()}).catch(O=>{l(F,Ue(O)),u()})}).catch(P=>{l(F,Ue(P)),u()})})},{getRootProps:D,getInputProps:b,isDragActive:w}=mr({onDrop:x,accept:r});return S.jsxs(Fe,{...D(),sx:{border:"2px dashed #eeeeee",borderRadius:"8px",padding:"40px",textAlign:"center",color:"#bdbdbd",transition:"border .24s ease-in-out","&:hover":{borderColor:"#2196f3"},...w&&{borderColor:"#2196f3"}},children:[S.jsx("input",{...b()}),S.jsx(Sr,{color:"primary",children:S.jsx(Rr,{fontSize:"large"})}),S.jsx(se,{variant:"h6",children:w?"Drop the files here ...":"Drag & drop some files here, or click to select files"}),p&&p.length>0&&p.map((v,F)=>S.jsxs(Fe,{sx:{width:"100%",mt:2},children:[S.jsx(jr,{variant:"determinate",value:v.progress,color:v.error?"error":"primary"}),v.error?S.jsx(Lr,{title:v.error,children:S.jsxs(se,{variant:"body2",color:v.error?"textDanger":"textPrimary",children:[v.name," - ",`${v.progress}%`]})}):S.jsxs(se,{variant:"body2",color:v.error?"textDanger":"textPrimary",children:[v.name," - ",`${v.progress}%`]})]},F))]})},Wt=Rt;class ir extends y.Component{constructor(r){super(r),this.scrollListener=this.scrollListener.bind(this),this.eventListenerOptions=this.eventListenerOptions.bind(this),this.mousewheelListener=this.mousewheelListener.bind(this)}componentDidMount(){this.pageLoaded=this.props.pageStart,this.options=this.eventListenerOptions(),this.attachScrollListener()}componentDidUpdate(){if(this.props.isReverse&&this.loadMore){const r=this.getParentElement(this.scrollComponent);r.scrollTop=r.scrollHeight-this.beforeScrollHeight+this.beforeScrollTop,this.loadMore=!1}this.attachScrollListener()}componentWillUnmount(){this.detachScrollListener(),this.detachMousewheelListener()}isPassiveSupported(){let r=!1;const t={get passive(){r=!0}};try{document.addEventListener("test",null,t),document.removeEventListener("test",null,t)}catch{}return r}eventListenerOptions(){let r=this.props.useCapture;return this.isPassiveSupported()?r={useCapture:this.props.useCapture,passive:!0}:r={passive:!1},r}setDefaultLoader(r){this.defaultLoader=r}detachMousewheelListener(){let r=window;this.props.useWindow===!1&&(r=this.scrollComponent.parentNode),r.removeEventListener("mousewheel",this.mousewheelListener,this.options?this.options:this.props.useCapture)}detachScrollListener(){let r=window;this.props.useWindow===!1&&(r=this.getParentElement(this.scrollComponent)),r.removeEventListener("scroll",this.scrollListener,this.options?this.options:this.props.useCapture),r.removeEventListener("resize",this.scrollListener,this.options?this.options:this.props.useCapture)}getParentElement(r){const t=this.props.getScrollParent&&this.props.getScrollParent();return t??(r&&r.parentNode)}filterProps(r){return r}attachScrollListener(){const r=this.getParentElement(this.scrollComponent);if(!this.props.hasMore||!r)return;let t=window;this.props.useWindow===!1&&(t=r),t.addEventListener("mousewheel",this.mousewheelListener,this.options?this.options:this.props.useCapture),t.addEventListener("scroll",this.scrollListener,this.options?this.options:this.props.useCapture),t.addEventListener("resize",this.scrollListener,this.options?this.options:this.props.useCapture),this.props.initialLoad&&this.scrollListener()}mousewheelListener(r){r.deltaY===1&&!this.isPassiveSupported()&&r.preventDefault()}scrollListener(){const r=this.scrollComponent,t=window,n=this.getParentElement(r);let i;if(this.props.useWindow){const c=document.documentElement||document.body.parentNode||document.body,p=t.pageYOffset!==void 0?t.pageYOffset:c.scrollTop;this.props.isReverse?i=p:i=this.calculateOffset(r,p)}else this.props.isReverse?i=n.scrollTop:i=r.scrollHeight-n.scrollTop-n.clientHeight;i<Number(this.props.threshold)&&r&&r.offsetParent!==null&&(this.detachScrollListener(),this.beforeScrollHeight=n.scrollHeight,this.beforeScrollTop=n.scrollTop,typeof this.props.loadMore=="function"&&(this.props.loadMore(this.pageLoaded+=1),this.loadMore=!0))}calculateOffset(r,t){return r?this.calculateTopPosition(r)+(r.offsetHeight-t-window.innerHeight):0}calculateTopPosition(r){return r?r.offsetTop+this.calculateTopPosition(r.offsetParent):0}render(){const r=this.filterProps(this.props),{children:t,element:n,hasMore:i,initialLoad:c,isReverse:p,loader:o,loadMore:m,pageStart:s,ref:a,threshold:u,useCapture:l,useWindow:f,getScrollParent:x,...D}=r;D.ref=w=>{this.scrollComponent=w,a&&a(w)};const b=[t];return i&&(o?p?b.unshift(o):b.push(o):this.defaultLoader&&(p?b.unshift(this.defaultLoader):b.push(this.defaultLoader))),Se.createElement(n,D,b)}}De(ir,"propTypes",{children:g.node.isRequired,element:g.node,hasMore:g.bool,initialLoad:g.bool,isReverse:g.bool,loader:g.node,loadMore:g.func.isRequired,pageStart:g.number,ref:g.func,getScrollParent:g.func,threshold:g.number,useCapture:g.bool,useWindow:g.bool}),De(ir,"defaultProps",{element:"div",hasMore:!1,initialLoad:!0,pageStart:0,ref:null,threshold:250,useWindow:!0,isReverse:!1,useCapture:!1,loader:null,getScrollParent:null});export{ir as I,Ht as M,Wt as U};
